{"version":3,"sources":["./dist/browser/umd/upscaler.js"],"names":["global","factory","exports","module","require","define","amd","globalThis","self","Upscaler","DefaultUpscalerJSModel","tf","this","DefaultUpscalerModel","tf$1","_interopNamespaceDefault","e","n","Object","create","keys","forEach","k","d","getOwnPropertyDescriptor","defineProperty","get","enumerable","default","freeze","MODEL_DEFINITION_VALIDATION_CHECK_ERROR_TYPE","tf__namespace","tf__namespace$1","isShape4D","Boolean","shape","Array","isArray","length","every","value","isFixedShape4D","makeIsNDimensionalTensor","rank","pixels","err","isFourDimensionalTensor","isThreeDimensionalTensor","isTensor","input","Tensor","isString","el","isValidModelType","modelType","includes","ModelDefinitionValidationError","Error","type","constructor","super","isNumber","isValidRange","range","warn","console","msg","join","isProgress","p","undefined","async","wrapGenerator","gen","postNext","let","result","await","next","done","nonNullable","processAndDisposeOfTensor","tensor","_processFns","processFns","filter","processedTensor","tidy","reduce","reducedTensor","processFn","isDisposed","dispose","WARNING_DEPRECATED_MODEL_DEFINITION_FN","WARNING_UNDEFINED_PADDING","WARNING_PROGRESS_WITHOUT_PATCH_SIZE","ERROR_INVALID_TENSOR_PREDICTED","JSON","stringify","ERROR_INVALID_MODEL_PREDICTION","GET_UNDEFINED_TENSORS_ERROR","AbortError","message","ERROR_INVALID_MODEL_TYPE","ERROR_MODEL_DEFINITION_BUG","WARNING_INPUT_SIZE_AND_PATCH_SIZE","GET_INVALID_PATCH_SIZE","patchSize","GET_INVALID_PATCH_SIZE_AND_PADDING","padding","GET_WARNING_PATCH_SIZE_INDIVISIBLE_BY_DIVISIBILITY_FACTOR","divisibilityFactor","upscaledPatchSize","MODEL_INPUT_SIZE_MUST_BE_SQUARE","GET_MODEL_CONFIGURATION_MISSING_PATH_AND_INTERNALS","modelConfiguration","makeTick","signal","awaitNextFrame","nextFrame","abortSignal","aborted","r","isWarmupSizeByPatchSize","size","isNumericWarmupSize","ERROR_INVALID_WARMUP_VALUE","getInvalidValueError","getWidthAndHeight","getSizesAsArray","sizes","cancellableWarmup","modelPackage","internalArgs","tick","model","modelDefinition","warmupSize","dummyTensor","zeros","yield","fn","preprocess","predict","t","postprocess","getModel","modelDef","setup","loadTfModel","modelPath","loadGraphModel","loadLayersModel","getModelInputShape","batchInputShape","LayersModel","layers","inputs","getPatchSizeAsMultiple","Math","ceil","parsePatchAndInputShapes","imageSize","modelInputShape","multipliedPatchSize","padInput","inputShape","pixelsHeight","pixelsWidth","height","max","width","rightTensor","bottomTensor","topTensor","concat","trimInput","scale","slice","scaleOutput","endingRange","clipByValue","mul","scaleIncomingPixels","concatTensors","tensors","axis","definedTensors","concatenatedTensor","get1DPatch","total","idx","preOrigin","prePadding","isBeyondBounds","postOrigin","postPadding","prePaddingAdjusted","postSize","increment","pre","origin","post","getPatchesFromImage","patches","x","y","preOriginY","preSizeY","postOriginY","postSizeY","yIncrement","min","row","preOriginX","preSizeX","postOriginX","postSizeX","xIncrement","push","executeModel","predictedPixels","processPixels","output","progress","progressOutput","originalImageSize","tensorAsBase64","upscaledTensor","rowIdx","columns","colTensor","colIdx","slicedPixels","prediction","startSlice","endSlice","slicedPrediction","processedPrediction","outputRange","col","percent","squeezedTensor","squeeze","src","sliceData","patchCoordinates","processedUpscaledTensor","clone","postprocessedTensor","upscale","args","getImageAsTensor","startingPixels","preprocessedPixels","inputRange","upscaledPixels","base64Src","DEFAULT_MODEL","getOutputOption","CDN_PATH_DEFINITIONS","jsdelivr","packageName","version","path","unpkg","CDNS","getLoadModelErrorMessage","errs","internals","name","map","cdn","ERROR_ENVIRONMENT_DISALLOWS_BASE64_URL","ERROR_ENVIRONMENT_DISALLOWS_STRING_INPUT_URL","getEnvironmentDisallowsStringInput","getEnvironmentDisallowsBase64","loadImage","Promise","resolve","reject","img","Image","crossOrigin","onload","onerror","fromPixels","browser","fromPixelsAsync","checkIfValidEnvironment","document","errFn","getUpscaleOptions","checkValidEnvironment","loadModel","_opts","_model","ready","_abortController","AbortController","opts","then","warmupSizes","catch","execute","image","options","internalConfig","bind","warmup","abort","teardown","_modelDefinition","UNDEFINED","INVALID_MODEL_TYPE","_internals","MISSING_PATH","error","parsedModelDefinition","getCDNFn","imgHTMLElement","expandedTensor","expandDims","arr","fill","dataSync","imageData","ImageData","canvas","data","set","createElement","ctx","getContext","putImageData","toDataURL"],"mappings":"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"}